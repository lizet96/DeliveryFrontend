<div class="delivery-dashboard">
  <!-- Navbar Simple y Profesional -->
  <div class="simple-navbar">
    <div class="navbar-content">
      <h1 class="app-title">DeliveryApp</h1>
      <p-button 
        icon="pi pi-lock" 
        label="Cerrar Sesión" 
        severity="secondary" 
        size="small"
        class="logout-btn"
        (click)="logout()">
      </p-button>
    </div>
  </div>

  <!-- Contenido Principal -->
  <div class="dashboard-content">
    <!-- Tarjetas de Estadísticas -->
    <div class="stats-grid">
      <p-card header="Entregas Pendientes" class="stat-card">
        <div class="stat-content">
          <i class="pi pi-clock stat-icon pending"></i>
          <div class="stat-number">2</div>
        </div>
      </p-card>
      
      <p-card header="En Tránsito" class="stat-card">
        <div class="stat-content">
          <i class="pi pi-truck stat-icon transit"></i>
          <div class="stat-number">2</div>
        </div>
      </p-card>
      
      <p-card header="Entregadas Hoy" class="stat-card">
        <div class="stat-content">
          <i class="pi pi-check-circle stat-icon delivered"></i>
          <div class="stat-number">1</div>
        </div>
      </p-card>
      
      <p-card header="Total Asignadas" class="stat-card">
        <div class="stat-content">
          <i class="pi pi-box stat-icon total"></i>
          <div class="stat-number">5</div>
        </div>
      </p-card>
    </div>

    <!-- Mapa de Entregas -->
    <div class="map-section">
      <p-card header="Mapa de Entregas" class="map-card">
        <div id="deliveryMap" class="delivery-map"></div>
      </p-card>
    </div>

    <!-- Tabla de Paquetes -->
    <div class="packages-section">
      <div class="table-header">
        <h2 class="table-title">Mis Entregas Asignadas</h2>
      </div>
      <p-card class="packages-card">
        <p-table [value]="packages" [tableStyle]="{'min-width': '50rem'}" styleClass="custom-table">
          <ng-template pTemplate="header">
            <tr>
              <th>ID Paquete</th>
              <th>Cliente</th>
              <th>Dirección</th>
              <th>Estado</th>
              <th>Prioridad</th>
              <th>Teléfono</th>
              <th>Acciones</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-package>
            <tr>
              <td>
                <span class="package-id">{{ package.id }}</span>
              </td>
              <td>
                <div class="customer-info">
                  <strong>{{ package.customer }}</strong>
                </div>
              </td>
              <td>
                <span class="address">{{ package.delivery_address }}</span>
              </td>
              <td>
                <span class="status-badge" [ngClass]="'status-' + package.status">
                  <i class="pi" [ngClass]="getStatusIcon(package.status)"></i>
                  {{ getStatusLabel(package.status) }}
                </span>
              </td>
              <td>
                <span class="priority-badge" [ngClass]="'priority-' + package.priority">
                  <i class="pi" [ngClass]="getPriorityIcon(package.priority)"></i>
                  {{ getPriorityLabel(package.priority) }}
                </span>
              </td>
              <td>
                <span class="phone">{{ package.phone }}</span>
              </td>
              <td>
                <p-button 
                  icon="pi pi-pencil" 
                  label="Editar Estatus" 
                  severity="info" 
                  size="small"
                  class="edit-status-btn"
                  (click)="editPackageStatus(package)">
                </p-button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-card>
    </div>
  </div>
  
  <!-- Modal para editar estado del paquete -->
  <p-dialog 
    header="Actualizar Estado del Paquete" 
    [(visible)]="showStatusModal" 
    [modal]="true" 
    [draggable]="false" 
    [resizable]="false"
    [style]="{width: '450px'}"
    (onHide)="closeStatusModal()">
    <div class="status-modal-content" *ngIf="selectedPackage">
      <div class="package-info">
        <div class="info-row">
          <span class="info-label">ID Paquete:</span>
          <span class="package-id">{{ selectedPackage.id }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Dirección:</span>
          <span class="address">{{ selectedPackage.delivery_address }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Estado Actual:</span>
          <span class="status-badge" [ngClass]="'status-' + selectedPackage.status">
            <i class="pi" [ngClass]="getStatusIcon(selectedPackage.status)"></i>
            {{ getStatusLabel(selectedPackage.status) }}
          </span>
        </div>
      </div>
      
      <div class="status-selection">
        <h3>Seleccionar Nuevo Estado:</h3>
        <div class="status-options">
          <div *ngFor="let option of statusOptions" class="status-option">
            <p-button 
              [label]="option.label" 
              [severity]="getStatusSeverity(option.value)" 
              [outlined]="selectedPackage.status !== option.value"
              [raised]="selectedPackage.status === option.value"
              (onClick)="updateStatus(option.value)">
            </p-button>
          </div>
          
          <div class="status-option cancel-option">
            <p-button 
              icon="pi pi-times" 
              label="Cancelar" 
              severity="secondary" 
              outlined
              (click)="closeStatusModal()">
            </p-button>
          </div>
        </div>
      </div>
    </div>
  </p-dialog>
</div>